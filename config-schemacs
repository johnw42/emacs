#! /bin/bash

with=${1-with}
shift

autoreconf

config_args=($with-chez-scheme --without-jpeg --without-makeinfo AM_DEFAULT_VERBOSITY=0)

if [[ $with == --with ]]; then
  config_args+=(--enable-checking=yes CANNOT_DUMP=yes --without-threads CFLAGS='-O0 -finline-functions -gdwarf-2 -g3 -Werror=implicit-function-declaration -Werror=nested-externs -fno-builtin')
fi

./configure "${config_args[@]}"
